openapi: 3.0.1
info:
  title: Provider Product API
  description: API contract for retrieving provider product details
  version: 1.0.0
servers:
  - url: http://localhost:8080/api
paths:
  /providers/{providerId}:
    get:
      summary: Get provider product details
      description: Returns product details based on provider ID and optional product type
      parameters:
        - $ref: '#/components/parameters/providerIdPathParam'
        - $ref: '#/components/parameters/productTypeQueryParam'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProviderProductResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Provider not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    ProviderProductResponse:
      type: object
      properties:
        providerId:
          type: string
        records:
          type: array
          items:
            $ref: '#/components/schemas/ProductTypeRecord'
      required:
        - providerId
        - records
    
    ProductTypeRecord:
      type: object
      properties:
        productType:
          type: string
          enum: [ISA, GIA, SIPP]
        details:
          type: array
          items:
            $ref: '#/components/schemas/ProductDetails'
      required:
        - productType
        - details

    ProductDetails:
      type: object
      properties:
        transferType:
          type: string
          enum: [RI, TI]
        accountPattern:
          type: string
          description: Comma-separated account pattern string
      required:
        - transferType
        - accountPattern

    Error:
      type: object
      properties:
        errorCode:
          type: string
        errorDescription:
          type: string
      required:
        - errorCode
        - errorDescription

  parameters:
    providerIdPathParam:
      name: providerId
      in: path
      required: true
      schema:
        type: string
      description: The unique provider ID

    productTypeQueryParam:
      name: productType
      in: query
      required: false
      schema:
        type: string
        enum: [ISA, GIA, SIPP]
      description: The type of product (optional)
