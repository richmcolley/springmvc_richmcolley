<!DOCTYPE html>
<html>
<head>
  <title>Upload and Display Excel Data</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#excelFileInput').change(function(e) {
        var file = e.target.files[0];
        var reader = new FileReader();

        reader.onload = function(e) {
          var data = new Uint8Array(e.target.result);
          var workbook = XLSX.read(data, { type: 'array' });
          var sheet = workbook.Sheets[workbook.SheetNames[0]];
          var jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

          // Display the Excel data in a table
          var table = '<table>';
          for (var i = 0; i < jsonData.length; i++) {
            table += '<tr>';
            for (var j = 0; j < jsonData[i].length; j++) {
              table += '<td>' + jsonData[i][j] + '</td>';
            }
            table += '</tr>';
          }
          table += '</table>';
          $('#excelData').html(table);

          // Pass the Excel file and data to the Spring MVC controller
          var formData = new FormData();
          formData.append('file', file);
          formData.append('jsonData', JSON.stringify(jsonData));

          $.ajax({
            url: '/upload',
            type: 'POST',
            data: formData,
            cache: false,
            contentType: false,
            processData: false,
            success: function(response) {
              console.log('Upload successful');
            },
            error: function(xhr, status, error) {
              console.error('Upload failed:', error);
            }
          });
        };

        reader.readAsArrayBuffer(file);
      });
    });
  </script>
</head>
<body>
  <input type="file" id="excelFileInput" accept=".xls, .xlsx" />
  <div id="excelData"></div>
</body>
</html>






import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.multipart.MultipartFile;

@Controller
@RequestMapping("/")
public class FileUploadController {

  @PostMapping("/upload")
  public String handleFileUpload(@RequestParam("file") MultipartFile file, @RequestParam("jsonData") String jsonData) {
    // Process the uploaded file and JSON data here
    // Example: Save the file to disk and perform operations with the JSON data
    
    System.out.println("Uploaded file name: " + file.getOriginalFilename());
    System.out.println("JSON data: " + jsonData);

    return "Upload successful";
  }

}
